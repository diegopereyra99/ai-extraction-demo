<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title data-i18n="app.title">Structured Data Extractor</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div id="configWarning" class="banner banner-warn" hidden></div>

    <header class="topbar">
      <div class="title-group">
        <h1 class="app-title" data-i18n="app.title">Structured Data Extractor</h1>
        <p class="app-subtitle" data-i18n="app.subtitle">Extract structured data from files using a custom schema you define here. Demo app; more complex scenarios are possible.</p>
      </div>
      <div class="spacer"></div>
      <span class="label lang-ico" aria-hidden="true" title="Language" data-i18n-title="header.language">üåê</span>
      <select id="langSelect" aria-label="Language selector">
        <option value="en">English</option>
        <option value="es">Espa√±ol</option>
        <option value="it">Italiano</option>
      </select>
      <button id="aboutBtn" class="icon-btn icon-text" aria-haspopup="dialog" aria-label="About this demo" title="About this demo" data-i18n-aria-label="about.title" data-i18n-title="about.title">
        <span aria-hidden="true">‚ÑπÔ∏è</span>
        <span class="btn-label" data-i18n="header.info">Info</span>
      </button>
      <button id="helpBtn" class="icon-btn icon-text" aria-haspopup="dialog" aria-label="Help" title="Help" data-i18n-aria-label="header.help" data-i18n-title="header.help">
        <span aria-hidden="true">‚ùî</span>
        <span class="btn-label" data-i18n="header.help">Help</span>
      </button>
    </header>

    <main class="container">
      <section class="panel" aria-labelledby="filesHeading">
        <h2 id="filesHeading" data-i18n="files.title">Files</h2>
        <div id="dropzone" class="dropzone" aria-label="Dropzone" role="button" tabindex="0" data-i18n-title="files.dropHint" title="Drag & drop files here or click to select">
          <p data-i18n="files.dropHint">Drag & drop files here</p>
        </div>
        <input id="fileInput" type="file" multiple hidden />
        <div id="fileSizeInfo" class="status" aria-live="polite"></div>
        <ul id="fileList" class="file-list" aria-live="polite"></ul>

        
      </section>

      <div class="right-col">
        <section class="panel" aria-labelledby="schemaHeading">
          <h2 id="schemaHeading" data-i18n="schema.configTitle">Schema & Configuration</h2>
          <div class="schema-builder">
            <div id="fieldsContainer" class="fields"></div>
            <div id="schemaErrors" class="status" role="status" aria-live="polite"></div>
            <div id="schemaPreviewBlock" class="row hidden">
              <h3 data-i18n="schema.preview">Schema (preview)</h3>
              <pre id="schemaPreview" class="preview"></pre>
            </div>
          </div>

          <div class="collapsible">
            <button id="advancedToggle" class="collapsible-header" aria-expanded="false">
              <span data-i18n="advanced.title">Advanced configuration</span>
              <span aria-hidden="true">‚ñæ</span>
            </button>
            <div id="advancedPanel" class="collapsible-content hidden">
              <div class="adv-grid">
                <section class="adv-section">
                  <h4 class="adv-title" data-i18n="advanced.sections.prompt">Prompt</h4>
                  <p class="adv-help" data-i18n="advanced.help.prompt">Short instruction about what to extract.</p>
                  <input id="promptInput" type="text" placeholder="Extract the requested fields from the input. Keep responses concise." />
                </section>
                <section class="adv-section">
                  <h4 class="adv-title" data-i18n="advanced.sections.system">System Instruction</h4>
                  <p class="adv-help" data-i18n="advanced.help.system">Global rules for the model behavior.</p>
                  <textarea id="systemInput" rows="4" placeholder="Do not fabricate data. Use null when information is missing. Follow the provided JSON schema strictly."></textarea>
                </section>
                <section class="adv-section">
                  <h4 class="adv-title" data-i18n="advanced.sections.model">Model</h4>
                  <p class="adv-help" data-i18n="advanced.help.model">Provider model to run extraction.</p>
                  <select id="modelSelect">
                    <option value="gemini-2.5-flash">gemini-2.5-flash</option>
                    <option value="gemini-2.0-flash">gemini-2.0-flash</option>
                  </select>
                </section>
                <section class="adv-section">
                  <h4 class="adv-title" data-i18n="advanced.sections.options">Options</h4>
                  <p class="adv-help" data-i18n="advanced.help.options">Additional toggles and display options.</p>
                  <label class="adv-check">
                    <input id="schemaPreviewToggle" type="checkbox" />
                    <span data-i18n="advanced.showPreview">Show schema preview</span>
                  </label>
                  <div style="margin-top:8px;">
                    <label class="adv-check">
                      <input id="asListToggle" type="checkbox" />
                      <span data-i18n="advanced.extractAsList">Extract as list</span>
                    </label>
                  </div>
                </section>
              </div>
            </div>
          </div>

          <div class="actions">
            <button id="submitBtn" class="primary" disabled data-i18n="actions.submit">Submit</button>
            <button id="clearBtn" data-i18n="actions.clear">Clear</button>
          </div>
        </section>

        <section class="panel" aria-labelledby="resultsHeading">
          <h2 id="resultsHeading" data-i18n="results.title">Results</h2>
          <div id="status" class="status" role="status" aria-live="polite"></div>
          <div id="result" class="result"></div>
        </section>
      </div>
    </main>

    <div class="site-footer">
      <span class="cta" data-i18n="footer.cta">Need to integrate this into your system? Contact:</span>
      <div class="contact">
        <a class="contact-item email" href="mailto:diego.pereyra99@gmail.com">diego.pereyra99@gmail.com</a>
        <a class="contact-item phone" href="tel:+33752050377">+33 7 52 05 03 77</a>
      </div>
    </div>

    <div id="ariaStatus" class="sr-only" aria-live="polite"></div>

    <!-- Help modal -->
    <div id="helpModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
      <div class="modal-backdrop" data-close="help"></div>
      <div class="modal-content" role="document">
        <div class="modal-header">
          <h3 id="helpTitle" data-i18n="help.title">How to use</h3>
          <button id="helpClose" class="icon-btn" aria-label="Close" title="Close" data-i18n-aria-label="actions.close" data-i18n-title="actions.close">√ó</button>
        </div>
        <div class="modal-body">
          <ul class="help-list">
            <li data-i18n="help.steps.config">Set API_URL in config.js (copy from config.example.js).</li>
            <li data-i18n="help.steps.fields">Add at least one field to the schema (Name, Type, Required).</li>
            <li data-i18n="help.steps.files">Optionally add files; multipart is used when files are present.</li>
            <li data-i18n="help.steps.submit">Click Submit. The app validates the schema; if invalid, it shows inline errors and does not send the request.</li>
            <li data-i18n="help.steps.limits">Keep total upload size small (‚âà &lt;20MB). The UI warns when near the limit.</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- About modal -->
    <div id="aboutModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="aboutTitle">
      <div class="modal-backdrop" data-close="about"></div>
      <div class="modal-content" role="document">
        <div class="modal-header">
          <h3 id="aboutTitle" data-i18n="about.title">About this demo</h3>
          <button id="aboutClose" class="icon-btn" aria-label="Close" title="Close" data-i18n-aria-label="actions.close" data-i18n-title="actions.close">√ó</button>
        </div>
        <div class="modal-body">
          <p data-i18n="about.intro">This tool shows how AI can read your documents and turn them into clean, structured data. Upload a file, define the fields you need, and see the results instantly ‚Äî no more copy-pasting or manual filling.</p>

          <h3 data-i18n="about.files.title">What kind of files can I process?</h3>
          <p data-i18n="about.files.intro">In this demo you can try PDFs and images ‚Äî whether scanned or digital. Common examples include:</p>
          <ul>
            <li data-i18n="about.files.items.0">Invoices and receipts ‚Üí totals, dates, VAT, vendor, product lines.</li>
            <li data-i18n="about.files.items.1">CVs and r√©sum√©s ‚Üí names, contact details, skills.</li>
            <li data-i18n="about.files.items.2">Product sheets ‚Üí SKU, price, attributes.</li>
          </ul>

          <h3 data-i18n="about.workflow.title">How could this fit into your workflow?</h3>
          <p data-i18n="about.workflow.intro">The same engine can be adapted in many ways, for example:</p>
          <ul>
            <li data-i18n="about.workflow.items.0">Watch a folder on your computer and automatically update a spreadsheet.</li>
            <li data-i18n="about.workflow.items.1">Read your email inbox and process attachments as they arrive.</li>
            <li data-i18n="about.workflow.items.2">Process a batch of files and create a new spreadsheet.</li>
          </ul>

          <h3 data-i18n="about.contact.title">Contact</h3>
          <p data-i18n="about.contact.prompt">Interested in exploring how this could save you time?</p>
          <p><a href="mailto:diego.pereyra99@gmail.com">diego.pereyra99@gmail.com</a><br/><a href="tel:+33752050377">+33 7 52 05 03 77</a></p>
        </div>
      </div>
    </div>

    <script src="./i18n.js"></script>
    <script src="./config.js" defer></script>
    <script src="./app.js"></script>
  </body>
  </html>
